webpackJsonp([2],{"+skl":function(t,e){},"/HAA":function(t,e){},"12sq":function(t,e){},"1dDz":function(t,e){},"4CAj":function(t,e){},"64oc":function(t,e){},"92bo":function(t,e){},DEgp:function(t,e){},DfXN:function(t,e){},Fcw0:function(t,e){},HMCp:function(t,e){},IWry:function(t,e){},MSE6:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("//Fk"),n=s.n(a),r=s("7+uW"),o=s("NYxO"),i=s("BTaQ"),c=s.n(i),l=(s("+skl"),s("mtWM")),u=s.n(l),p={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"router-view"},[e("router-view")],1)])},staticRenderFns:[]};var h=s("VU/8")({name:"App",components:{},data:function(){return{}},created:function(){},methods:{}},p,!1,function(t){s("xiRJ")},null,null).exports,d=s("/ocq"),m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"layout"},[s("Layout",[s("Header",{style:{position:"fixed",width:"100%"}},[s("Menu",{attrs:{mode:"horizontal",theme:"dark","active-name":"1"}},[s("div",{staticClass:"layout-logo"}),t._v(" "),s("div",{staticClass:"layout-nav"},[s("MenuItem",{attrs:{name:"1"}},[s("Icon",{attrs:{type:"ios-navigate"}}),t._v("\n                        Item 1\n                    ")],1),t._v(" "),s("MenuItem",{attrs:{name:"2"}},[s("Icon",{attrs:{type:"ios-keypad"}}),t._v("\n                        Item 2\n                    ")],1),t._v(" "),s("MenuItem",{attrs:{name:"3"}},[s("Icon",{attrs:{type:"ios-analytics"}}),t._v("\n                        Item 3\n                    ")],1),t._v(" "),s("MenuItem",{attrs:{name:"4"}},[s("Icon",{attrs:{type:"ios-paper"}}),t._v("\n                        Item 4\n                    ")],1)],1)])],1),t._v(" "),s("Content",{style:{margin:"88px 20px 0",background:"#fff",minHeight:"500px"}},[t._v("\n            Content\n        ")]),t._v(" "),s("Footer",{staticClass:"layout-footer-center"},[t._v("2011-2016 © TalkingData")])],1)],1)},staticRenderFns:[]};var f=s("VU/8")({},m,!1,function(t){s("92bo")},"data-v-102122a8",null).exports,v={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"layout"},[e("Layout",[e("Header",[e("Menu",{attrs:{mode:"horizontal",theme:"dark","active-name":"1"}},[e("div",{staticClass:"layout-logo"},[e("router-link",{attrs:{to:"/home"}},[e("img",{attrs:{src:"/static/favicon.ico"}})])],1),this._v(" "),e("div",{staticClass:"layout-nav"})])],1),this._v(" "),e("Content",{style:{padding:"0 50px",background:"rgba(255,255,255,0.2)"}},[e("div",{staticClass:"main"},[this._t("share")],2)]),this._v(" "),e("Footer",{staticClass:"layout-footer-center"},[this._v("\n            2017-2018 ©\n            "),e("a",{attrs:{href:this.api.github,target:"_blank"}},[this._v("kloud "),e("Icon",{attrs:{type:"social-github"}})],1)])],1)],1)},staticRenderFns:[]};var g=s("VU/8")({name:"Share",components:{},props:{},data:function(){return{}},methods:{}},v,!1,function(t){s("lf27")},null,null).exports,_={name:"Login",components:{Share:g},data:function(){return{email:"",password:""}},methods:{valid:function(){try{if(this.email=this.email.trim(),""===this.email)throw"帐号不能为空";if(this.password=this.password.trim(),""===this.password)throw"密码不能为空";return!0}catch(t){this.$Message.error(t)}},submit:function(){var t=this;if(console.log(this.email," --\x3e ",this.password),this.valid()){var e=this.api.sha2Password(this.password);this.http.post(this.api.login,{email:this.email,password:e,maxAge:31536e3}).then(function(e){console.log(e.status),200===e.status?(t.$store.dispatch("login",e.data),t.$router.push("/home/")):(console.log(e.data.msg),t.$Message.error("登录失败: "+e.data.msg))}).catch(function(t){return t})}}}},y={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Share",[s("template",{slot:"share"},[s("section",{staticClass:"login"},[s("div",{staticClass:"box"},[s("div",{staticClass:"input last"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.email,expression:"email",modifiers:{trim:!0}}],attrs:{type:"text",maxlength:"50",placeholder:"帐号"},domProps:{value:t.email},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submit(e):null},input:function(e){e.target.composing||(t.email=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"input last"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.password,expression:"password",modifiers:{trim:!0}}],attrs:{type:"password",maxlength:"50",placeholder:"密码"},domProps:{value:t.password},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submit(e):null},input:function(e){e.target.composing||(t.password=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"get-access-token"},[s("router-link",{attrs:{to:"/signin"}},[t._v("注册")])],1),t._v(" "),s("div",{staticClass:"submit user-select-none",on:{click:t.submit}},[t._v("登录")])])])])],2)},staticRenderFns:[]};var C=s("VU/8")(_,y,!1,function(t){s("OAom")},"data-v-64a247d6",null).exports,b={name:"Signin",components:{Share:g},data:function(){return{name:"",email:"",password:"",passwordCheck:""}},methods:{valid:function(){try{if(""===this.name)throw"名字不能为空";if(""===this.email)throw"邮箱不能为空";if(""===this.password)throw"密码不能为空";if(this.password.length<6)throw"密码不能小于6位";if(this.password!==this.passwordCheck)throw"确认密码失败：不相等";return!0}catch(t){this.$Message.error(t)}},submit:function(){var t=this;if(this.valid()){var e=this.api.sha2Password(this.password);this.http.post(this.api.signin,{name:this.name,email:this.email,password:e}).then(function(e){200===e.status?(t.$Message.success("注册成功，转到登录页面"),t.$router.replace("/login")):(console.log(e.data),t.$Message.error(e.status+": "+e.data.msg))}).catch(function(e){t.$Message.error("网络连接错误 ",e)})}}}},k={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Share",[s("template",{slot:"share"},[s("section",{staticClass:"login"},[s("div",{staticClass:"box"},[s("div",{staticClass:"input last"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.name,expression:"name",modifiers:{trim:!0}}],attrs:{type:"text",maxlength:"50",placeholder:"名字"},domProps:{value:t.name},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submit(e):null},input:function(e){e.target.composing||(t.name=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"input last"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.email,expression:"email",modifiers:{trim:!0}}],attrs:{type:"text",maxlength:"50",placeholder:"邮箱"},domProps:{value:t.email},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submit(e):null},input:function(e){e.target.composing||(t.email=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"input last"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.password,expression:"password",modifiers:{trim:!0}}],attrs:{type:"password",maxlength:"50",placeholder:"密码"},domProps:{value:t.password},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submit(e):null},input:function(e){e.target.composing||(t.password=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"input last"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.passwordCheck,expression:"passwordCheck",modifiers:{trim:!0}}],attrs:{type:"password",maxlength:"50",placeholder:"确认密码"},domProps:{value:t.passwordCheck},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submit(e):null},input:function(e){e.target.composing||(t.passwordCheck=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"get-access-token"},[s("a",{attrs:{href:"/#/login"}},[t._v("登录")])]),t._v(" "),s("div",{staticClass:"submit user-select-none",on:{click:t.submit}},[t._v("注册")])])])])],2)},staticRenderFns:[]};var S=s("VU/8")(b,k,!1,function(t){s("1dDz")},"data-v-154e9967",null).exports,$={name:"404",components:{Share:g},data:function(){return{title:"404 页面不存在"}},created:function(){},methods:{}},w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Share",[s("template",{slot:"share"},[s("div",{staticClass:"_404"},[s("h1",[t._v(t._s(t.title))]),t._v(" "),s("div",{staticClass:"bigb"}),t._v(" "),s("p",[s("router-link",{attrs:{to:"/login"}},[t._v("登录")]),t._v("\n    或\n    "),s("router-link",{attrs:{to:"/signin"}},[t._v("注册")])],1),t._v(" "),s("div",{staticClass:"bigb"})])])],2)},staticRenderFns:[]};var x=s("VU/8")($,w,!1,function(t){s("OFwx")},"data-v-22b22bfe",null).exports,M={name:"Home",components:{},created:function(){this.$store.dispatch("checkLogin")},data:function(){return{}},computed:{user:function(){return this.$store.state.isLogin?this.$store.state.userInfo:""},spaceStr:function(){return this.user?this.api.size(this.user.curSize)+"/"+this.api.size(this.user.maxSize):""},spacePercent:function(){return this.user?(console.log(this.user.curSize,this.user.maxSize),console.log(this.user.curSize/this.user.maxSize),console.log((this.user.curSize/this.user.maxSize).toFixed(0)),100*(this.user.curSize/this.user.maxSize).toFixed(0)):0}},methods:{logout:function(){this.$store.dispatch("logout"),this.$Message.success("已登出！"),this.$router.replace("/login/")}}},T={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"layout"},[s("Layout",[s("Header",[s("Menu",{attrs:{mode:"horizontal",theme:"dark","active-name":"1"}},[s("div",{staticClass:"layout-logo"},[s("router-link",{attrs:{to:"/home"}},[s("img",{attrs:{src:"/static/favicon.ico"}})])],1),t._v(" "),s("div",{staticClass:"layout-nav"},[0===t.user.role?s("MenuItem",{attrs:{name:"0"}},[s("router-link",{attrs:{to:"/admin"}},[s("div",{staticClass:"user"},[s("Icon",{attrs:{type:"stats-bars"}}),t._v("\n                            系统管理\n                           ")],1)])],1):t._e(),t._v(" "),s("MenuItem",{attrs:{name:"1"}},[s("router-link",{attrs:{to:"/settings"}},[t.user.avatarURL?s("Avatar",{attrs:{src:t.user.avatarURL}}):t._e(),t._v(" "),t.user.avatarURL?t._e():s("Avatar",{attrs:{icon:"person"}}),t._v(" "),s("span",{staticClass:"user"},[t._v(" "+t._s(t.user.name)+" ")])],1)],1),t._v(" "),s("MenuItem"),t._v(" "),s("MenuItem",{attrs:{name:"2"}},[s("div",{staticClass:"user",on:{click:t.logout}},[s("Icon",{attrs:{type:"log-out"}}),t._v("\n                            登出\n                           ")],1)])],1)])],1),t._v(" "),s("Layout",{style:{background:"#fff"}},[s("Sider",{style:{background:"#fff"},attrs:{"hide-trigger":""}},[s("Menu",{attrs:{theme:"dark","active-name":"1",width:"auto",id:"menu-box"}},[s("MenuItem",{staticClass:"nav-item",attrs:{name:"1"}},[s("router-link",{attrs:{to:"/home"}},[s("Icon",{attrs:{type:"folder"}}),t._v("\n                                全部文件\n                               ")],1)],1),t._v(" "),s("MenuItem"),t._v(" "),s("MenuItem",{staticClass:"nav-item",attrs:{name:"1"}},[s("router-link",{attrs:{to:"/trashes"}},[s("Icon",{attrs:{type:"ios-trash-outline"}}),t._v("\n                                回收站\n                               ")],1)],1),t._v(" "),s("MenuItem"),t._v(" "),s("MenuItem",{staticClass:"nav-item",attrs:{name:"2"}},[s("router-link",{attrs:{to:"/shares"}},[s("Icon",{attrs:{type:"android-share-alt"}}),t._v("\n                                我的分享\n                               ")],1)],1),t._v(" "),s("MenuItem"),t._v(" "),s("MenuItem",{staticClass:"nav-item",attrs:{name:"3"}},[s("router-link",{attrs:{to:"/publics"}},[s("Icon",{attrs:{type:"earth"}}),t._v("\n                                公共文件\n                               ")],1)],1),t._v(" "),s("MenuItem"),t._v(" "),s("MenuItem",{staticClass:"nav-item",attrs:{name:"4"}}),t._v(" "),s("div",{staticClass:"state"},[s("p",[t._v(t._s(t.spaceStr))]),t._v(" "),s("p",[s("Progress",{attrs:{percent:t.spacePercent}})],1),t._v(" "),s("p"),t._v(" "),s("p"),t._v(" "),s("p"),t._v(" "),s("p",[t._v("Powered by")]),t._v(" "),s("a",{attrs:{href:this.api.github,target:"_blank"}},[s("Icon",{attrs:{type:"social-github"}}),t._v("\n                                 kloud\n                              ")],1)])],1)],1),t._v(" "),s("Content",{style:{background:"#fff"}},[t._t("home")],2)],1)],1)],1)},staticRenderFns:[]};var A=s("VU/8")(M,T,!1,function(t){s("Fcw0")},"data-v-02f0ee81",null).exports,I={name:"HomeSettings",components:{Home:A},created:function(){},watch:{userInfo:function(){this.user=this.fetchData(),this.avatarURL=this.user.avatarURL}},data:function(){return{user:this.fetchData(),avatarURL:this.fetchData().avatarURL,password:"",passwordCheck:""}},computed:{isLogin:function(){return this.$store.state.isLogin},userInfo:function(){return this.$store.state.userInfo}},methods:{fetchData:function(){var t=this.$store.state.userInfo;if(t)return t.createTimeStr=this.api.dateTime(t.createTime),t.curSizeStr=this.api.size(t.curSize),t.maxSizeStr=this.api.size(t.maxSize),t.roleStr=this.api.role(t.role),t},submit:function(){var t=this;if(console.log("submit :",this.user.avatarURL,"\n",this.password," --\x3e ",this.passwordCheck),this.password===this.passwordCheck){if(""!==this.password&&this.password.length<6)this.$Message.error("密码长度不能小于6");else if(this.user.avatarURL!==this.avatarURL&&this.http.post(this.api.avatarURL,{avatarURL:this.avatarURL}).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("修改头像成功"),t.cancel()):(console.log(e.data.msg),t.$Message.error("修改头像失败: "+e.data.msg))}).catch(function(t){return t}),""!==this.password){var e=this.api.sha2Password(this.password);this.http.post(this.api.password,{password:e}).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("修改密码成功"),console.log("logout"),t.$store.dispatch("logout"),t.$Message.success("已登出！"),t.$router.replace("/login/")):(console.log(e.data.msg),t.$Message.error("修改密码失败: "+e.data.msg))}).catch(function(t){return t})}}else this.$Message.error("密码确认失败： 不相等")},cancel:function(){this.$store.dispatch("checkLogin"),this.password="",this.passwordCheck="",this.avatarURL=this.user.avatarURL}}},R={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Home",[s("template",{slot:"home"},[s("div",{staticClass:"count"},[t.user?s("Form",{ref:"user",attrs:{"label-width":80}},[s("Row",[s("Col",{attrs:{span:"2",offset:"1"}},[t.user.avatarURL?s("Avatar",{attrs:{src:t.user.avatarURL,size:"large"}}):t._e(),t._v(" "),t.user.avatarURL?t._e():s("Avatar",{attrs:{icon:"person",size:"large"}})],1)],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"2"}},[t._v("名字：")]),t._v(" "),s("Col",{attrs:{span:"12"}},[t._v(t._s(t.user.name))])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"2"}},[t._v("邮箱：")]),t._v(" "),s("Col",{attrs:{span:"12"}},[t._v(t._s(t.user.email))])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"2"}},[t._v("角色：")]),t._v(" "),s("Col",{attrs:{span:"12"}},[t._v(t._s(t.user.roleStr))])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"2"}},[t._v("创建时间：")]),t._v(" "),s("Col",{attrs:{span:"12"}},[t._v(t._s(t.user.createTimeStr))])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"2"}},[t._v("总容量：")]),t._v(" "),s("Col",{attrs:{span:"12"}},[t._v(t._s(t.user.maxSizeStr))])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"2"}},[t._v("已用容量：")]),t._v(" "),s("Col",{attrs:{span:"12"}},[t._v(t._s(t.user.curSizeStr))])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"2"}},[t._v("头像：")]),t._v(" "),s("Col",{attrs:{span:"12"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.avatarURL,expression:"avatarURL"}],attrs:{type:"text",size:"80%"},domProps:{value:t.avatarURL},on:{input:function(e){e.target.composing||(t.avatarURL=e.target.value)}}})])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"2"}},[t._v("密码：")]),t._v(" "),s("Col",{attrs:{span:"12"}},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.password,expression:"password",modifiers:{trim:!0}}],attrs:{type:"password",size:"80%"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])],1),t._v(" "),s("Row",[s("Col",{attrs:{span:"2"}},[t._v("确认密码：")]),t._v(" "),s("Col",{attrs:{span:"12"}},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.passwordCheck,expression:"passwordCheck",modifiers:{trim:!0}}],attrs:{type:"password",size:"80%"},domProps:{value:t.passwordCheck},on:{input:function(e){e.target.composing||(t.passwordCheck=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})])],1),t._v(" "),s("Row",[s("FormItem",[s("Col",{attrs:{span:"3",offset:"3"}},[s("Button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("提交")])],1),t._v(" "),s("Col",{attrs:{span:"3"}},[s("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.cancel}},[t._v("取消")])],1)],1)],1)],1):t._e()],1)])],2)},staticRenderFns:[]};var E=s("VU/8")(I,R,!1,function(t){s("IWry")},"data-v-f3bc0d9e",null).exports,V={name:"Paths",props:{paths:Array},data:function(){return{}},methods:{},computed:{}},N={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"path"},[s("span",[s("router-link",{class:1===t.paths.length&&"focus",attrs:{to:"/home/"+t.paths[0].id}},[t._v("全部文件")])],1),t._v(" "),t._l(t.paths,function(e,a){return"/"!==e.name?s("span",{key:e.id},[s("router-link",{class:a+1===t.paths.length&&"focus",attrs:{to:"/home/"+e.id}},[t._v(t._s(e.name)+"/")])],1):t._e()})],2)},staticRenderFns:[]};var U=s("VU/8")(V,N,!1,function(t){s("q+Pj")},"data-v-352dd71d",null).exports,L={name:"PathTree",data:function(){return{data:[{title:"/",id:"",loading:!1,expand:!0,children:[]}]}},methods:{fetchSubs:function(t,e){this.http.get(this.api.entrySubs+t.id).then(function(t){if(console.log(t.status),200===t.status){var s=t.data.data.filter(function(t){return t.title=t.name,t.expand=!1,t.children=[],t.loading=!1,""===t.fileId});e(s)}}).catch(function(t){return t})},pathTreeChange:function(t){console.log("pathTreeChange:",t[0].id,t[0].name),this.$emit("pathTreeChange",t[0].id)}}},z={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"path-tree"},[e("Tree",{attrs:{data:this.data,"load-data":this.fetchSubs},on:{"on-select-change":this.pathTreeChange}})],1)},staticRenderFns:[]};var D=s("VU/8")(L,z,!1,function(t){s("fRer")},"data-v-386e7d00",null).exports,P={name:"AgeSelector",props:{name:String,age:Number},data:function(){return{tmpAge:this.age||0,ageList:[{name:"永久",value:0},{name:"一天",value:86400},{name:"一周",value:604800},{name:"一月",value:2592e3},{name:"半年",value:15552e3},{name:"一年",value:31536e3}]}},created:function(){this.change()},watch:{tmpAge:function(){this.change()}},methods:{change:function(){this.$emit("AgeSelectorChange",parseInt(this.tmpAge))}}},F={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("span",[t._v(t._s(t.name)+" "),s("select",{directives:[{name:"model",rawName:"v-model",value:t.tmpAge,expression:"tmpAge"}],on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.tmpAge=e.target.multiple?s:s[0]}}},t._l(t.ageList,function(e){return s("option",{key:e.value,domProps:{value:e.value}},[t._v("\n    "+t._s(e.name)+"\n    ")])}))])},staticRenderFns:[]};var B=s("VU/8")(P,F,!1,function(t){s("MSE6")},"data-v-2a62d553",null).exports,H={name:"PsEditor",components:{AgeSelector:B},props:{value:String,valueName:String,placeHolder:String},data:function(){return{age:0,tmpValue:this.value}},created:function(){this.change()},methods:{change:function(){this.$emit("PsEditorChange",this.tmpValue,parseInt(this.age))},input:function(){this.change()},ageChange:function(t){this.age=t,this.change()}}},O={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"Ps"},[s("span",[t._v(t._s(t.valueName)+":  "),s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.tmpValue,expression:"tmpValue",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:t.placeHolder},domProps:{value:t.tmpValue},on:{input:[function(e){e.target.composing||(t.tmpValue=e.target.value.trim())},t.input],blur:function(e){t.$forceUpdate()}}})]),t._v(" "),s("p"),t._v(" "),s("AgeSelector",{attrs:{name:"过期时间",age:t.age},on:{AgeSelectorChange:t.ageChange}})],1)},staticRenderFns:[]};var j=s("VU/8")(H,O,!1,function(t){s("dkXx")},"data-v-32d6a064",null).exports,q={name:"PsSuccess",props:{title:String,url:String},data:function(){return{tmpUrl:this.url}},mounted:function(){var t=this.$refs.url.href;console.log(t),this.tmpUrl=t},methods:{copyLink:function(){this.api.copyLink()}},computed:{}},Q={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("h1",[t._v(t._s(t.title))]),t._v(" "),s("span",[s("a",{ref:"url",attrs:{href:t.url,target:"_blank"}},[t._v(t._s(t.tmpUrl))]),t._v(" "),s("Tooltip",{attrs:{content:"点击复制",placement:"top"}},[s("Button",{staticClass:"btn",attrs:{type:"primary",shape:"circle",icon:"clipboard","data-clipboard-text":t.tmpUrl},on:{click:t.copyLink}})],1)],1)])},staticRenderFns:[]};var W=s("VU/8")(q,Q,!1,function(t){s("bnQL")},"data-v-e6bd1e90",null).exports,J={name:"Entry",components:{PsEditor:j,PsSuccess:W},props:{curEntry:Object,entry:Object,index:Number,subs:Array},data:function(){return{tmpState:this.entry.state,tmpValue:"",tmpValueName:"",tmpAge:0,tmpPlaceHolder:"",tmpMoveToId:""}},computed:{url:function(){return this.entry.fileId?this.api.entryFile+this.entry.id+"/"+this.entry.name:"/home/"+this.entry.id}},methods:{update:function(){this.$emit("update")},check:function(){this.$emit("check",this.index,this.tmpState)},rename:function(){var t=this;console.log("reName",this.index,this.entry.name),this.tmpValue=this.entry.name,this.$Modal.confirm({render:function(e){return e("Input",{props:{value:t.tmpValue,autofocus:!0},on:{input:function(e){console.log(t.tmpValue," -> ",e),t.tmpValue=e,console.log(t.api.isValidEntryName(t.tmpDir))}}})},title:"重命名："+this.entry.name,closable:!0,scrollable:!0,onOk:function(){if(!t.api.isValidEntryName(t.tmpDir))return t.$Message.error("名字不能含/或\\且不能是.或者..");if(t.tmpValue!==t.entry.name){for(var e=0;e<t.subs.length;e++)if(t.tmpValue===t.subs[e].name)return t.$Message.error("'"+t.tmpValue+"' 在当前目录已经存在");t.http.put(t.api.entryRename+t.entry.id,{name:t.tmpValue}).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("重命名成功"),t.update()):(console.log(e.data.msg),t.$Message.error("重命名失败: "+e.data.msg))}).catch(function(t){return t})}}})},moveto:function(){var t=this;this.tmpMoveToId=this.$store.state.rootEntryId,console.log("moveTo:",this.tmpMoveToId,this.index,this.entry.name),this.$Modal.confirm({render:function(e){return e(D,{on:{pathTreeChange:function(e){t.tmpMoveToId=e||t.$store.state.rootEntryId}}})},title:"移动到",closable:!0,scrollable:!0,onOk:function(){t.tmpMoveToId!==t.curEntry.id&&(t.tmpMoveToId!==t.entry.id?t.http.put(t.api.entryMoveto+t.tmpMoveToId,{id:t.entry.id}).then(function(e){200===e.status?t.$Message.success("移动成功"):(console.log(e.data.msg),t.$Message.error("移动失败: "+e.data.msg)),t.update()}).catch(function(t){return t}):t.$Message.error("不能移动到自身或其子目录下"))}})},trash:function(){var t=this;this.http.put(this.api.entryTrash+this.entry.id).then(function(e){200===e.status?t.$Message.success("移动到回收站成功"):(console.log(e.data.msg),t.$Message.error("移动到回收站失败: "+e.data.msg)),t.update()}).catch(function(t){return t})},share:function(){var t=this;this.tmpValueName="密码",this.tmpValue="",this.tmpAge=0,this.tmpPlaceHolder="空表示没有密码",console.log("share:",this.index,this.entry.name),this.$Modal.confirm({render:function(e){return e(j,{props:{value:t.tmpValue,valueName:t.tmpValueName,placeHolder:t.tmpPlaceHolder},on:{PsEditorChange:function(e,s){t.tmpValue=e,t.tmpAge=s,console.log(t.tmpValue,t.tmpAge)}}})},title:"分享："+this.entry.name,closable:!0,scrollable:!0,onOk:function(){t.http.post(t.api.entryShare+t.entry.id,{password:t.tmpValue,maxAge:t.tmpAge}).then(function(e){200===e.status?(t.tmpValue="/#/share/"+e.data.data.id+"/info",t.$Message.success({render:function(e){return e(W,{attrs:{title:"分享文件成功",url:t.tmpValue}})},duration:8,closable:!0})):(console.log(e.data.msg),t.$Message.error("分享文件失败: "+e.data.msg))}).catch(function(t){return t})}})},publik:function(){var t=this;this.tmpValueName="Referer正则",this.tmpValue="",this.tmpAge=0,this.tmpPlaceHolder="空表示没有限制 Referer",console.log("public:",this.index,this.entry.name),this.$Modal.confirm({render:function(e){return e(j,{props:{value:t.tmpValue,valueName:t.tmpValueName,placeHolder:t.tmpPlaceHolder},on:{PsEditorChange:function(e,s){t.tmpValue=e,t.tmpAge=s,console.log(t.tmpValue,t.tmpAge)}}})},title:"公开："+this.entry.name,closable:!0,scrollable:!0,onOk:function(){t.http.post(t.api.entryPublic+t.entry.id,{referer:t.tmpValue,maxAge:t.tmpAge}).then(function(e){200===e.status?(t.tmpValue=t.api.publicFile+e.data.data.id+"/"+e.data.data.name,t.$Message.success({render:function(e){return e(W,{attrs:{title:"公开文件成功",url:t.tmpValue}})},duration:8,closable:!0})):(console.log(e.data.msg),t.$Message.error("公开文件失败: "+e.data.msg))}).catch(function(t){return t})}})}}},X={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.entry?s("div",{staticClass:"entry"},[s("Row",[s("Col",{attrs:{span:"1"}},[s("Checkbox",{on:{"on-change":t.check},model:{value:t.tmpState,callback:function(e){t.tmpState=e},expression:"tmpState"}})],1),t._v(" "),t.entry.fileId?s("Col",{attrs:{span:"12"}},[s("a",{attrs:{target:"_blank",href:t.url}},[t._v(t._s(t.entry.name))])]):t._e(),t._v(" "),t.entry.fileId?t._e():s("Col",{attrs:{span:"12"}},[s("router-link",{attrs:{to:t.url}},[t._v(t._s(t.entry.name)+"/")])],1),t._v(" "),s("Col",{attrs:{span:"1"}},[t._v(t._s(t.entry.sizeStr))]),t._v(" "),s("Col",{attrs:{span:"3",offset:"1"}},[t._v(t._s(t.entry.modifyTimeStr))]),t._v(" "),s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"重命名",placement:"left"}},[s("Button",{attrs:{type:"primary",shape:"circle",icon:"edit"},on:{click:t.rename}})],1)],1),t._v(" "),s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"移动",placement:"left"}},[s("Button",{attrs:{type:"primary",shape:"circle",icon:"arrow-move"},on:{click:t.moveto}})],1)],1),t._v(" "),s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"删除，移动到回收站",placement:"left"}},[s("Button",{attrs:{type:"error",shape:"circle",icon:"trash-a"},on:{click:t.trash}})],1)],1),t._v(" "),s("Col",{attrs:{span:"1"}},[t.entry.fileId?s("Tooltip",{attrs:{content:"分享该文件",placement:"left"}},[s("Button",{attrs:{type:"primary",shape:"circle",icon:"android-share-alt"},on:{click:t.share}})],1):t._e()],1),t._v(" "),s("Col",{attrs:{span:"1"}},[t.entry.fileId?s("Tooltip",{attrs:{content:"公开该文件",placement:"left"}},[s("Button",{attrs:{type:"primary",shape:"circle",icon:"earth"},on:{click:t.publik}})],1):t._e()],1)],1)],1):t._e()},staticRenderFns:[]};var Y=s("VU/8")(J,X,!1,function(t){s("DEgp")},"data-v-27d110ef",null).exports,Z={name:"HomeFiles",components:{Home:A,Paths:U,PathTree:D,Entry:Y},created:function(){var t=this.$root&&this.$route.params.id||"";this.fetchData(t)},data:function(){return{loading:!1,paths:[],subs:[],tmpDir:"新建文件夹",tmpMoveToId:"",tmpSelectedNum:0,tmpCount:0}},computed:{userInfo:function(){return this.$store.state.userInfo},curEntry:function(){return this.paths.length>0?this.paths[this.paths.length-1]:null},fileApi:function(){return this.api.entryFilePost+this.curEntry.id},selected:function(){return this.selectedNum>0},selectedNum:function(){for(var t=0,e=0;e<this.subs.length;e++)!0===this.subs[e].state&&t++;return t}},watch:{$route:function(t){console.log("watch$routeTo: '",t.params.id,"'"),this.fetchData(t.params.id)}},methods:{fetchData:function(t){var e=this,s="";t&&"undefined"!==t&&(s=t,this.fetchSubs(s)),console.log(s),this.http.get(this.api.entryPath+s).then(function(t){console.log(t.status,e.paths.length);e.paths.length>0&&e.paths[e.paths.length-1],e.updatePaths(t.data.data);var s=e.paths[e.paths.length-1];e.$store.state.rootEntryId!==e.paths[0].id&&e.$store.commit("updateRootEntryId",e.paths[0].id),e.$route.params.id&&e.$route.params.id===s.id||(console.log("this.$router.replaceTo: /home/"+s.id),e.$router.replace("/home/"+s.id))}).catch(function(t){return t})},fetchSubs:function(t){var e=this,s=t||this.$route.params.id;this.http.get(this.api.entrySubs+s).then(function(t){console.log(t.status),200===t.status&&e.updateSubs(t.data.data)}).catch(function(t){return t})},updatePaths:function(t){console.log(this.paths.length,"->",t.length),this.paths=t},updateSubs:function(t){console.log(this.subs.length,"->",t.length);for(var e=0;e<t.length;e++){var s=t[e];s.createTimeStr=this.api.dateTime(s.createTime),s.modifyTimeStr=this.api.dateTime(s.modifyTime),s.state=!1,""===s.fileId?s.sizeStr="-":s.sizeStr=this.api.size(s.file.size),this.subs.splice(e,1,s)}this.subs.length=t.length,0==t.length&&this.subs.splice(0,this.subs.length)},uploadSuccess:function(){console.log("上传成功"),this.$Message.success("上传成功"),this.fetchSubs()},uploadFailed:function(){console.log("上传失败"),this.$Message.error("上传失败")},entryCheck:function(t,e){console.log(t,this.subs[t].name,this.subs[t].state," -> ",e),this.subs[t].state=e},selectAll:function(){console.log("selectAll",this.selected," -> ",!this.selected);for(var t=this.selected,e=0;e<this.subs.length;e++)this.entryCheck(e,!t);console.log("selectedNum: ",this.selectedNum)},makedir:function(){var t=this;console.log("makedir"),this.$Modal.confirm({render:function(e){return e("Input",{props:{value:t.tmpDir,autofocus:!0},on:{input:function(e){console.log(t.tmpDir," -> ",e),t.tmpDir=e,console.log(t.api.isValidEntryName(t.tmpDir))}}})},title:"新建文件夹",closable:!0,scrollable:!0,onCancel:function(){},onOk:function(){if(!t.api.isValidEntryName(t.tmpDir))return t.$Message.error("名字不能含/或\\且不能是.或者..");for(var e=0;e<t.subs.length;e++)if(t.tmpDir===t.subs[e].name)return t.$Message.error("'"+t.tmpDir+"' 在当前目录已经存在");t.http.post(t.api.entryDirPost+t.curEntry.id,{name:t.tmpDir}).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("新建文件夹成功"),t.fetchSubs()):(console.log(e.data.msg),t.$Message.error("新建文件夹失败: "+e.data.msg))}).catch(function(t){return t})}})},moveSelectedTo:function(){var t=this;this.tmpSelectedNum=this.selectedNum,this.tmpCount=0,this.tmpMoveToId=this.$store.state.rootEntryId,console.log("moveSelectedTo:",this.tmpCount,"/",this.tmpSelectedNum),this.$Modal.confirm({render:function(e){return e(D,{on:{pathTreeChange:function(e){t.tmpMoveToId=e||t.$store.state.rootEntryId}}})},title:"移动到",closable:!0,scrollable:!0,onCancel:function(){},onOk:function(){for(var e=0;e<t.subs.length;e++)if(t.subs[e].state){if(t.tmpMoveToId===t.curEntry.id)return;if(t.tmpMoveToId===t.subs[e].id)return void t.$Message.error("不能移动到自身或其子目录下");t.http.put(t.api.entryMoveto+t.tmpMoveToId,{id:t.subs[e].id}).then(function(e){200===e.status?(t.$Message.success("移动成功"),t.tmpCount++,console.log(t.tmpCount,"/",t.tmpSelectedNum),t.tmpCount==t.tmpSelectedNum&&t.fetchSubs()):(console.log(e.data.msg),t.$Message.error("移动失败: "+e.data.msg),t.fetchSubs())}).catch(function(t){return t})}}})},deleteSelected:function(){var t=this;console.log("deleteSelected",this.selectedNum),this.tmpSelectedNum=this.selectedNum,this.tmpCount=0,console.log("Trash:",this.tmpCount,"/",this.tmpSelectedNum);for(var e=0;e<this.subs.length;e++)this.subs[e].state&&this.http.put(this.api.entryTrash+this.subs[e].id).then(function(e){200===e.status?(t.$Message.success("移动到回收站成功"),t.tmpCount++,console.log(t.tmpCount,"/",t.tmpSelectedNum),t.tmpCount==t.tmpSelectedNum&&t.fetchSubs()):(console.log(e.data.msg),t.$Message.error("移动到回收站失败: "+e.data.msg),t.fetchSubs())}).catch(function(t){return t})}}},G={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Home",[s("template",{slot:"home"},[t.curEntry?s("div",[s("div",[t.selected?s("Row",[s("Col",{attrs:{span:"2"}},[s("span",{staticClass:"count"},[t._v(t._s(t.selectedNum))]),s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.selectAll}},[t._v("全选")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"error",size:"large"},on:{click:t.deleteSelected}},[t._v("删除")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.moveSelectedTo}},[t._v("移动到")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.makedir}},[t._v("+ 创建文件夹")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Upload",{attrs:{action:"/apiv1/entry/file"}},[s("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"}},[t._v("上传文件")])],1)],1)],1):s("Row",[s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.selectAll}},[t._v("全选")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.makedir}},[t._v("+ 创建文件夹")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Upload",{attrs:{action:t.fileApi,name:"file","with-credentials":!0,"show-upload-list":!1,"on-success":t.uploadSuccess,"on-error":t.uploadFailed}},[s("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"}},[t._v("上传文件")])],1)],1)],1)],1),t._v(" "),s("Paths",{attrs:{paths:t.paths}}),t._v(" "),s("Row",[s("div",{staticClass:"count attr"},[s("Col",{attrs:{span:"12",offset:"1"}},[t._v("名字")]),t._v(" "),s("Col",{attrs:{span:"1"}},[t._v("大小")]),t._v(" "),s("Col",{attrs:{span:"3",offset:"2"}},[t._v("修改时间")])],1)]),t._v(" "),t._l(t.subs,function(e,a){return s("div",{key:""+t.selected+t.subs.length+e.id},[s("Entry",{attrs:{entry:e,index:a,curEntry:t.curEntry,subs:t.subs},on:{update:t.fetchSubs,check:t.entryCheck}})],1)})],2):t._e()])],2)},staticRenderFns:[]};var K=s("VU/8")(Z,G,!1,function(t){s("m/qo")},"data-v-53b85a68",null).exports,tt={name:"TrashedEntry",components:{},props:{entry:Object,index:Number},data:function(){return{tmpState:this.entry.state}},computed:{url:function(){return this.entry.fileId?this.api.entryFile+this.entry.id+"/"+this.entry.name:"/home/"+this.entry.id}},methods:{update:function(){this.$emit("update")},check:function(){this.$emit("check",this.index,this.tmpState)},untrash:function(){var t=this;this.http.put(this.api.entryUnTrash+this.entry.id).then(function(e){200===e.status?t.$Message.success("恢复成功"):(console.log(e.data.msg),t.$Message.error("恢复失败: "+e.data.msg)),t.update()}).catch(function(t){return t})},remove:function(){var t=this;this.http.delete(this.api.entryDelete+this.entry.id).then(function(e){200===e.status?t.$Message.success("删除成功"):(console.log(e.data.msg),t.$Message.error("删除失败: "+e.data.msg)),t.update()}).catch(function(t){return t})}}},et={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.entry?s("div",{staticClass:"entry"},[s("Row",[s("Col",{attrs:{span:"1"}},[s("Checkbox",{on:{"on-change":t.check},model:{value:t.tmpState,callback:function(e){t.tmpState=e},expression:"tmpState"}})],1),t._v(" "),t.entry.fileId?s("Col",{attrs:{span:"12"}},[s("a",{attrs:{target:"_blank",href:t.url}},[t._v(t._s(t.entry.name))])]):t._e(),t._v(" "),t.entry.fileId?t._e():s("Col",{attrs:{span:"12"}},[s("router-link",{attrs:{to:t.url}},[t._v(t._s(t.entry.name)+"/")])],1),t._v(" "),s("Col",{attrs:{span:"1"}},[t._v(t._s(t.entry.sizeStr))]),t._v(" "),s("Col",{attrs:{span:"3",offset:"1"}},[t._v(t._s(t.entry.deleteTimeStr))]),t._v(" "),s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"恢复",placement:"left"}},[s("Button",{attrs:{type:"success",shape:"circle",icon:"ios-undo"},on:{click:t.untrash}})],1)],1),t._v(" "),s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"彻底删除",placement:"left"}},[s("Button",{attrs:{type:"error",shape:"circle",icon:"close"},on:{click:t.remove}})],1)],1)],1)],1):t._e()},staticRenderFns:[]};var st={name:"HomeSettings",components:{Home:A,TrashedEntry:s("VU/8")(tt,et,!1,function(t){s("c8Qy")},"data-v-004963a2",null).exports},created:function(){this.fetchData()},watch:{isLogin:function(){this.fetchData()}},data:function(){return{trashes:[],tmpCount:0}},computed:{isLogin:function(){return this.$store.state.isLogin},selected:function(){return this.selectedNum>0},selectedNum:function(){for(var t=0,e=0;e<this.trashes.length;e++)!0===this.trashes[e].state&&t++;return t}},methods:{fetchData:function(){var t=this,e=this.$store.state.userInfo;void 0!==e&&null!==e&&""!==e.id&&this.http.get(this.api.entryTrashes).then(function(e){console.log(e.status),200===e.status?t.updateTrashes(e.data.data):t.$Message.error(e.data.msg)}).catch(function(t){return t})},updateTrashes:function(t){console.log(this.trashes.length,"->",t.length);for(var e=0;e<t.length;e++){var s=t[e];s.createTimeStr=this.api.dateTime(s.createTime),s.deleteTimeStr=this.api.dateTime(s.deleteTime),s.deleteTimeStr||(s.deleteTimeStr="-"),s.state=!1,""===s.fileId?s.sizeStr="-":s.sizeStr=this.api.size(s.file.size),this.trashes.splice(e,1,s)}this.trashes.length=t.length,0==t.length&&this.trashes.splice(0,this.trashes.length)},entryCheck:function(t,e){console.log(t,this.trashes[t].name,this.trashes[t].state," -> ",e),this.trashes[t].state=e},selectAll:function(){console.log("selectAll",this.selected," -> ",!this.selected);for(var t=this.selected,e=0;e<this.trashes.length;e++)this.entryCheck(e,!t);console.log("selectedNum: ",this.selectedNum)},untrashSelected:function(){var t=this;this.tmpCount=0;for(var e=0;e<this.trashes.length;e++)this.trashes[e].state&&this.http.put(this.api.entryUnTrash+this.trashes[e].id).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("恢复成功"),t.tmpCount++,t.tmpCount===t.selectedNum&&t.fetchData()):(console.log(e.data.msg),t.$Message.error("恢复失败: "+e.data.msg),t.fetchData())}).catch(function(t){return t})},deleteSelected:function(){var t=this;this.tmpCount=0;for(var e=0;e<this.trashes.length;e++)this.trashes[e].state&&this.http.delete(this.api.entryDelete+this.trashes[e].id).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("删除成功"),t.tmpCount++,t.tmpCount===t.selectedNum&&t.fetchData()):(console.log(e.data.msg),t.$Message.error("删除失败: "+e.data.msg),t.fetchData())}).catch(function(t){return t})},removeAll:function(){var t=this;this.tmpCount=0;for(var e=0;e<this.trashes.length;e++)this.http.delete(this.api.entryDelete+this.trashes[e].id).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("删除成功"),t.tmpCount++,t.tmpCount===t.trashes.length&&t.fetchData()):(console.log(e.data.msg),t.$Message.error("删除失败: "+e.data.msg),t.fetchData())}).catch(function(t){return t})}}},at={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Home",[s("template",{slot:"home"},[t.isLogin?s("div",[s("div",[t.selected?s("Row",[s("Col",{attrs:{span:"2"}},[s("bold",{staticClass:"count"},[t._v(t._s(t.selectedNum)+" ")]),s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.selectAll}},[t._v("全选")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"success",size:"large"},on:{click:t.untrashSelected}},[t._v("恢复")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"error",size:"large"},on:{click:t.deleteSelected}},[t._v("彻底删除")])],1),t._v(" "),s("Col",{attrs:{span:"2",offset:"16"}},[s("Button",{attrs:{type:"error",size:"large"},on:{click:t.removeAll}},[t._v("清空回收站")])],1)],1):s("Row",[s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.selectAll}},[t._v("全选")])],1),t._v(" "),s("Col",{attrs:{span:"2",offset:"20"}},[s("Button",{attrs:{type:"error",size:"large"},on:{click:t.removeAll}},[t._v("清空回收站")])],1)],1)],1),t._v(" "),s("Row",[s("div",{staticClass:"count attr"},[s("Col",{attrs:{span:"12",offset:"1"}},[t._v("名字")]),t._v(" "),s("Col",{attrs:{span:"1"}},[t._v("大小")]),t._v(" "),s("Col",{attrs:{span:"3",offset:"2"}},[t._v("删除时间")])],1)]),t._v(" "),t._l(t.trashes,function(e,a){return s("div",{key:""+t.selected+t.trashes.length+e.id},[s("TrashedEntry",{attrs:{entry:e,index:a},on:{update:t.fetchData,check:t.entryCheck}})],1)})],2):t._e()])],2)},staticRenderFns:[]};var nt=s("VU/8")(st,at,!1,function(t){s("64oc")},"data-v-2870fd5b",null).exports,rt={name:"SharedEntry",components:{AgeSelector:B},props:{entry:Object,index:Number},data:function(){return{tmpState:this.entry.state,tmpValue:"",tmpAge:0}},computed:{url:function(){return"/#/share/"+this.entry.id+"/info"}},methods:{update:function(){this.$emit("update")},check:function(){this.$emit("check",this.index,this.tmpState)},editPassword:function(){var t=this;console.log("editPassword",this.index,this.entry.name),this.tmpValue=this.entry.password,this.$Modal.confirm({render:function(e){return e("Input",{props:{value:t.tmpValue,autofocus:!0,placeholder:"空表示没有密码"},on:{input:function(e){console.log(t.tmpValue," -> ",e),t.tmpValue=e}}})},title:"编辑密码："+this.entry.name,closable:!0,scrollable:!0,onOk:function(){t.tmpValue!==t.entry.password&&t.http.put(t.api.sharePassword+t.entry.id,{password:t.tmpValue}).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("编辑密码成功"),t.update()):(console.log(e.data.msg),t.$Message.error("编辑密码失败: "+e.data.msg))}).catch(function(t){return t})}})},editMaxAge:function(){var t=this;console.log("editMaxAge",this.index,this.entry.name),this.tmpAge=0,this.$Modal.confirm({render:function(e){return e(B,{props:{age:t.tmpAge,name:"过期时间"},on:{AgeSelectorChange:function(e){console.log(t.tmpAge," -> ",e),t.tmpAge=e}}})},title:"编辑 过期时间："+this.entry.name,closable:!0,scrollable:!0,onOk:function(){t.http.put(t.api.shareMaxAge+t.entry.id,{maxAge:t.tmpAge}).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("编辑过期时间成功"),t.update()):(console.log(e.data.msg),t.$Message.error("编辑过期时间失败: "+e.data.msg))}).catch(function(t){return t})}})},remove:function(){var t=this;this.http.delete(this.api.shareDelete+this.entry.id).then(function(e){200===e.status?t.$Message.success("删除成功"):(console.log(e.data.msg),t.$Message.error("删除失败: "+e.data.msg)),t.update()}).catch(function(t){return t})}}},ot={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.entry?s("div",{staticClass:"entry"},[s("Row",[s("Col",{attrs:{span:"1"}},[s("Checkbox",{on:{"on-change":t.check},model:{value:t.tmpState,callback:function(e){t.tmpState=e},expression:"tmpState"}})],1),t._v(" "),s("Col",{attrs:{span:"9"}},[s("a",{attrs:{target:"_blank",href:t.url}},[t._v(t._s(t.entry.name))])]),t._v(" "),s("Col",{attrs:{span:"3"}},[t._v(t._s(t.entry.password))]),t._v(" "),t.entry.password?s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"编辑密码",placement:"left"}},[s("Button",{attrs:{type:"primary",shape:"circle",icon:"edit"},on:{click:t.editPassword}})],1)],1):t._e(),t._v(" "),t.entry.password?t._e():s("Col",{attrs:{span:"1",offset:"3"}},[s("Tooltip",{attrs:{content:"编辑密码",placement:"left"}},[s("Button",{attrs:{type:"primary",shape:"circle",icon:"edit"},on:{click:t.editPassword}})],1)],1),t._v(" "),s("Col",{attrs:{span:"3",offset:"1"}},[t._v(t._s(t.entry.expireTimeStr))]),t._v(" "),s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"编辑过期时间",placement:"left"}},[s("Button",{attrs:{type:"primary",shape:"circle",icon:"android-time"},on:{click:t.editMaxAge}})],1)],1),t._v(" "),s("Col",{attrs:{span:"3",offset:"1"}},[t._v(t._s(t.entry.createTimeStr))]),t._v(" "),s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"删除此分享",placement:"left"}},[s("Button",{attrs:{type:"error",shape:"circle",icon:"close"},on:{click:t.remove}})],1)],1)],1)],1):t._e()},staticRenderFns:[]};var it={name:"HomeShares",components:{Home:A,SharedEntry:s("VU/8")(rt,ot,!1,function(t){s("/HAA")},"data-v-137e5a4a",null).exports},created:function(){this.fetchData()},watch:{isLogin:function(){this.fetchData()}},data:function(){return{shares:[],tmpCount:0}},computed:{isLogin:function(){return this.$store.state.isLogin},selected:function(){return this.selectedNum>0},selectedNum:function(){for(var t=0,e=0;e<this.shares.length;e++)!0===this.shares[e].state&&t++;return t}},methods:{fetchData:function(){var t=this,e=this.$store.state.userInfo;void 0!==e&&null!==e&&""!==e.id&&this.http.get(this.api.shares).then(function(e){console.log(e.status),200===e.status?t.updateShares(e.data.data):t.$Message.error(e.data.msg)}).catch(function(t){return t})},updateShares:function(t){console.log(this.shares.length,"->",t.length);for(var e=0;e<t.length;e++){var s=t[e];s.createTimeStr=this.api.dateTime(s.createTime),s.expireTimeStr=this.api.dateTime(s.expireTime),s.expireTimeStr||(s.expireTimeStr="-"),s.state=!1,this.shares.splice(e,1,s)}this.shares.length=t.length,0==t.length&&this.shares.splice(0,this.shares.length)},entryCheck:function(t,e){console.log(t,this.shares[t].name,this.shares[t].state," -> ",e),this.shares[t].state=e},selectAll:function(){console.log("selectAll",this.selected," -> ",!this.selected);for(var t=this.selected,e=0;e<this.shares.length;e++)this.entryCheck(e,!t);console.log("selectedNum: ",this.selectedNum)},deleteSelected:function(){var t=this;this.tmpCount=0;for(var e=0;e<this.shares.length;e++)this.shares[e].state&&this.http.delete(this.api.shareDelete+this.shares[e].id).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("删除成功"),t.tmpCount++,t.tmpCount===t.selectedNum&&t.fetchData()):(console.log(e.data.msg),t.$Message.error("删除失败: "+e.data.msg),t.fetchData())}).catch(function(t){return t})}}},ct={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Home",[s("template",{slot:"home"},[t.isLogin?s("div",[s("div",[t.selected?s("Row",[s("Col",{attrs:{span:"2"}},[s("bold",{staticClass:"count"},[t._v(t._s(t.selectedNum)+" ")]),s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.selectAll}},[t._v("全选")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"error",size:"large"},on:{click:t.deleteSelected}},[t._v("删除")])],1)],1):s("Row",[s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.selectAll}},[t._v("全选")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"error",size:"large"},on:{click:t.deleteSelected}},[t._v("删除")])],1)],1)],1),t._v(" "),s("Row",[s("div",{staticClass:"count attr"},[s("Col",{attrs:{span:"9",offset:"1"}},[t._v("名字")]),t._v(" "),s("Col",{attrs:{span:"4"}},[t._v("密码")]),t._v(" "),s("Col",{attrs:{span:"3",offset:"1"}},[t._v("过期时间")]),t._v(" "),s("Col",{attrs:{span:"3",offset:"3"}},[t._v("分享时间")])],1)]),t._v(" "),t._l(t.shares,function(e,a){return s("div",{key:""+t.selected+t.shares.length+e.id},[s("SharedEntry",{attrs:{entry:e,index:a},on:{update:t.fetchData,check:t.entryCheck}})],1)})],2):t._e()])],2)},staticRenderFns:[]};var lt=s("VU/8")(it,ct,!1,function(t){s("ebsp")},"data-v-6df88921",null).exports,ut={name:"ShareInit",components:{Share:g},data:function(){return{password:""}},methods:{submit:function(){var t=this;console.log("submit:",this.$route.params.id,this.password),this.http.post(this.api.shareInit+this.$route.params.id,{password:this.password}).then(function(e){if(console.log(e.status),200===e.status){t.$Message.success("验证成功，马上跳转");var s="/#/share/"+e.data.data.id+"/info";window.location.href=s}else console.log(e.data.msg),t.$Message.error("验证失败: "+e.data.msg)}).catch(function(t){return t})}}},pt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Share",[s("template",{slot:"share"},[s("section",{staticClass:"login"},[s("div",{staticClass:"box"},[s("div",{staticClass:"input last"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.password,expression:"password",modifiers:{trim:!0}}],attrs:{type:"text",maxlength:"50",placeholder:"请输入分享的密钥"},domProps:{value:t.password},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.submit(e):null},input:function(e){e.target.composing||(t.password=e.target.value.trim())},blur:function(e){t.$forceUpdate()}}})]),t._v(" "),s("div",{staticClass:"get-access-token"},[s("router-link",{attrs:{to:"/login"}},[t._v("登录")]),t._v("\n                或\n                "),s("router-link",{attrs:{to:"/signin"}},[t._v("注册")])],1),t._v(" "),s("div",{staticClass:"submit user-select-none",on:{click:t.submit}},[t._v("提交")])])])])],2)},staticRenderFns:[]};var ht=s("VU/8")(ut,pt,!1,function(t){s("12sq")},"data-v-026d2f79",null).exports,dt={name:"ShareInfo",components:{Share:g},data:function(){return{share:null,notf:!1}},created:function(){var t=this,e=this.$route.params.id;this.http.get(this.api.shareInfo+e).then(function(e){console.log(e.status),200===e.status?(e.data.data.sizeStr=t.api.size(e.data.data.entry.file.size),t.share=e.data.data):(t.$Message.error(e.data.msg),t.notf=!0)}).catch(function(t){return t})},computed:{url:function(){return this.api.shareFile+this.share.id+"/"+this.share.name}},methods:{}},mt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Share",[s("template",{slot:"share"},[s("div",{staticClass:"shareInfo"},[t.share?s("div",[s("h1",[t._v("下载："+t._s(t.share.name))]),t._v(" "),s("p"),t._v(" "),s("h2",[t._v("大小："+t._s(t.share.sizeStr))]),t._v(" "),s("div",{staticClass:"bigb"}),t._v(" "),s("a",{attrs:{href:t.url,download:""}},[s("Button",{attrs:{type:"primary",icon:"android-download",size:"large"}})],1)]):t._e(),t._v(" "),t.notf?s("div",{staticClass:"shareInfo"},[s("h1",[t._v("找不到该分享")]),t._v(" "),s("div",{staticClass:"bigb"})]):t._e(),t._v(" "),s("div",{staticClass:"bigb"}),t._v(" "),s("p",[s("router-link",{attrs:{to:"/login"}},[t._v("登录")]),t._v("\n        或\n        "),s("router-link",{attrs:{to:"/signin"}},[t._v("注册")])],1)])])],2)},staticRenderFns:[]};var ft=s("VU/8")(dt,mt,!1,function(t){s("4CAj")},"data-v-09f28a16",null).exports,vt={name:"PublicedEntry",components:{AgeSelector:B},props:{entry:Object,index:Number},data:function(){return{tmpState:this.entry.state,tmpValue:"",tmpAge:0}},computed:{url:function(){return this.api.publicFile+this.entry.id+"/"+this.entry.name}},methods:{update:function(){this.$emit("update")},check:function(){this.$emit("check",this.index,this.tmpState)},editReferer:function(){var t=this;console.log("editReferer",this.index,this.entry.name),this.tmpValue=this.entry.referer,this.$Modal.confirm({render:function(e){return e("Input",{props:{value:t.tmpValue,autofocus:!0,placeholder:"空表示允许任意 Referer"},on:{input:function(e){console.log(t.tmpValue," -> ",e),t.tmpValue=e}}})},title:"编辑 Referer正则："+this.entry.name,closable:!0,scrollable:!0,onOk:function(){t.tmpValue!==t.entry.referer&&t.http.put(t.api.publicReferer+t.entry.id,{referer:t.tmpValue}).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("编辑 Referer正则 成功"),t.update()):(console.log(e.data.msg),t.$Message.error("编辑 Referer正则 失败: "+e.data.msg))}).catch(function(t){return t})}})},editMaxAge:function(){var t=this;console.log("editMaxAge",this.index,this.entry.name),this.tmpAge=0,this.$Modal.confirm({render:function(e){return e(B,{props:{age:t.tmpAge,name:"过期时间"},on:{AgeSelectorChange:function(e){console.log(t.tmpAge," -> ",e),t.tmpAge=e}}})},title:"编辑 过期时间："+this.entry.name,closable:!0,scrollable:!0,onOk:function(){t.http.put(t.api.publicMaxAge+t.entry.id,{maxAge:t.tmpAge}).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("编辑过期时间成功"),t.update()):(console.log(e.data.msg),t.$Message.error("编辑过期时间失败: "+e.data.msg))}).catch(function(t){return t})}})},remove:function(){var t=this;this.http.delete(this.api.publicDelete+this.entry.id).then(function(e){200===e.status?t.$Message.success("删除成功"):(console.log(e.data.msg),t.$Message.error("删除失败: "+e.data.msg)),t.update()}).catch(function(t){return t})}}},gt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return t.entry?s("div",{staticClass:"entry"},[s("Row",[s("Col",{attrs:{span:"1"}},[s("Checkbox",{on:{"on-change":t.check},model:{value:t.tmpState,callback:function(e){t.tmpState=e},expression:"tmpState"}})],1),t._v(" "),s("Col",{attrs:{span:"9"}},[s("a",{attrs:{target:"_blank",href:t.url}},[t._v(t._s(t.entry.name))])]),t._v(" "),s("Col",{attrs:{span:"3"}},[t._v(t._s(t.entry.referer))]),t._v(" "),t.entry.referer?s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"编辑 Referer正则",placement:"left"}},[s("Button",{attrs:{type:"primary",shape:"circle",icon:"edit"},on:{click:t.editReferer}})],1)],1):t._e(),t._v(" "),t.entry.referer?t._e():s("Col",{attrs:{span:"1",offset:"3"}},[s("Tooltip",{attrs:{content:"编辑 Referer正则",placement:"left"}},[s("Button",{attrs:{type:"primary",shape:"circle",icon:"edit"},on:{click:t.editReferer}})],1)],1),t._v(" "),s("Col",{attrs:{span:"3",offset:"1"}},[t._v(t._s(t.entry.expireTimeStr))]),t._v(" "),s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"编辑过期时间",placement:"left"}},[s("Button",{attrs:{type:"primary",shape:"circle",icon:"android-time"},on:{click:t.editMaxAge}})],1)],1),t._v(" "),s("Col",{attrs:{span:"3",offset:"1"}},[t._v(t._s(t.entry.createTimeStr))]),t._v(" "),s("Col",{attrs:{span:"1"}},[s("Tooltip",{attrs:{content:"删除此公开",placement:"left"}},[s("Button",{attrs:{type:"error",shape:"circle",icon:"close"},on:{click:t.remove}})],1)],1)],1)],1):t._e()},staticRenderFns:[]};var _t={name:"Homepublics",components:{Home:A,PublicedEntry:s("VU/8")(vt,gt,!1,function(t){s("DfXN")},"data-v-0c5abc73",null).exports},created:function(){this.fetchData()},watch:{isLogin:function(){this.fetchData()}},data:function(){return{publics:[],tmpCount:0}},computed:{isLogin:function(){return this.$store.state.isLogin},selected:function(){return this.selectedNum>0},selectedNum:function(){for(var t=0,e=0;e<this.publics.length;e++)!0===this.publics[e].state&&t++;return t}},methods:{fetchData:function(){var t=this,e=this.$store.state.userInfo;void 0!==e&&null!==e&&""!==e.id&&this.http.get(this.api.publics).then(function(e){console.log(e.status),200===e.status?t.updatePublics(e.data.data):t.$Message.error(e.data.msg)}).catch(function(t){return t})},updatePublics:function(t){console.log(this.publics.length,"->",t.length);for(var e=0;e<t.length;e++){var s=t[e];s.createTimeStr=this.api.dateTime(s.createTime),s.expireTimeStr=this.api.dateTime(s.expireTime),s.expireTimeStr||(s.expireTimeStr="-"),s.state=!1,this.publics.splice(e,1,s)}this.publics.length=t.length,0==t.length&&this.publics.splice(0,this.publics.length)},entryCheck:function(t,e){console.log(t,this.publics[t].name,this.publics[t].state," -> ",e),this.publics[t].state=e},selectAll:function(){console.log("selectAll",this.selected," -> ",!this.selected);for(var t=this.selected,e=0;e<this.publics.length;e++)this.entryCheck(e,!t);console.log("selectedNum: ",this.selectedNum)},deleteSelected:function(){var t=this;this.tmpCount=0;for(var e=0;e<this.publics.length;e++)this.publics[e].state&&this.http.delete(this.api.publicDelete+this.publics[e].id).then(function(e){console.log(e.status),200===e.status?(t.$Message.success("删除成功"),t.tmpCount++,t.tmpCount===t.selectedNum&&t.fetchData()):(console.log(e.data.msg),t.$Message.error("删除失败: "+e.data.msg),t.fetchData())}).catch(function(t){return t})}}},yt={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Home",[s("template",{slot:"home"},[t.isLogin?s("div",[s("div",[t.selected?s("Row",[s("Col",{attrs:{span:"2"}},[s("bold",{staticClass:"count"},[t._v(t._s(t.selectedNum)+" ")]),s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.selectAll}},[t._v("全选")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"error",size:"large"},on:{click:t.deleteSelected}},[t._v("删除")])],1)],1):s("Row",[s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"primary",size:"large"},on:{click:t.selectAll}},[t._v("全选")])],1),t._v(" "),s("Col",{attrs:{span:"2"}},[s("Button",{attrs:{type:"error",size:"large"},on:{click:t.deleteSelected}},[t._v("删除")])],1)],1)],1),t._v(" "),s("Row",[s("div",{staticClass:"count attr"},[s("Col",{attrs:{span:"9",offset:"1"}},[t._v("名字")]),t._v(" "),s("Col",{attrs:{span:"4"}},[t._v("Referer正则")]),t._v(" "),s("Col",{attrs:{span:"3",offset:"1"}},[t._v("过期时间")]),t._v(" "),s("Col",{attrs:{span:"3",offset:"2"}},[t._v("公开时间")])],1)]),t._v(" "),t._l(t.publics,function(e,a){return s("div",{key:""+t.selected+t.publics.length+e.id},[s("PublicedEntry",{attrs:{entry:e,index:a},on:{update:t.fetchData,check:t.entryCheck}})],1)})],2):t._e()])],2)},staticRenderFns:[]};var Ct=s("VU/8")(_t,yt,!1,function(t){s("HMCp")},"data-v-89391666",null).exports;r.default.use(d.a);var bt,kt=new d.a({routes:[{path:"/home",component:K},{path:"",redirect:"/home"},{path:"/",redirect:"/home"},{path:"/home/:id",component:K},{path:"/trashes",component:nt},{path:"/shares",component:lt},{path:"/share/:id/info",component:ft},{path:"/share/:id/init",component:ht},{path:"/publics",component:Ct},{path:"/settings",component:E},{path:"/login",component:C},{path:"/signin",component:S},{path:"/admin",component:function(){return s.e(0).then(s.bind(null,"iU2R"))}},{path:"/admin/users",component:function(){return s.e(0).then(s.bind(null,"5wS7"))}},{path:"/admin/user/:id",component:function(){return s.e(0).then(s.bind(null,"FJVa"))}},{path:"/admin/newUser",component:function(){return s.e(0).then(s.bind(null,"WfBx"))}},{path:"/admin/files",component:function(){return s.e(0).then(s.bind(null,"OOou"))}},{path:"/test",component:f},{path:"*",component:x}]}),St=s("bOdI"),$t=s.n(St),wt=s("mP1F"),xt=s.n(wt),Mt=s("TQvf"),Tt=s.n(Mt),At="http://localhost:8080",It=RegExp("[\\\\/]"),Rt=(bt={github:"https://github.com/biluohc/kloud",signin:At+"/apiv1/signin",login:At+"/apiv1/login",avatarURL:At+"/apiv1/user/avatar",password:At+"/apiv1/user/password",entryPath:At+"/apiv1/entry/path/",entrySubs:At+"/apiv1/entry/subs/",entryInfo:At+"/apiv1/entry/info/",entryFile:At+"/apiv1/entry/file/",entryTrashes:At+"/apiv1/entry/trashes",entryDirPost:At+"/apiv1/entry/dir/",entryFilePost:At+"/apiv1/entry/file/",entrySha1Post:At+"/apiv1/entry/sha1/",entryRename:At+"/apiv1/entry/rename/",entryMoveto:At+"/apiv1/entry/moveto/",entryTrash:At+"/apiv1/entry/trash/",entryUnTrash:At+"/apiv1/entry/untrash/",entryDelete:At+"/apiv1/entry/",entryShare:At+"/apiv1/entry/share/",shares:At+"/apiv1/shares",shareFile:At+"/apiv1/share/",shareInit:At+"/apiv1/share/:id/:name/init",sharePassword:At+"/apiv1/share/password/",shareInfo:At+"/apiv1/share/info/"},$t()(bt,"shareInit",At+"/apiv1/share/init/"),$t()(bt,"shareMaxAge",At+"/apiv1/share/maxage/"),$t()(bt,"shareDelete",At+"/apiv1/share/"),$t()(bt,"entryPublic",At+"/apiv1/entry/public/"),$t()(bt,"publics",At+"/apiv1/publics"),$t()(bt,"publicFile",At+"/apiv1/public/"),$t()(bt,"publicReferer",At+"/apiv1/public/referer/"),$t()(bt,"publicMaxAge",At+"/apiv1/public/maxage/"),$t()(bt,"publicDelete",At+"/apiv1/public/"),$t()(bt,"stat",At+"/Apiv1/stat"),$t()(bt,"logFile",At+"/Apiv1/log.txt"),$t()(bt,"users",At+"/Apiv1/users"),$t()(bt,"user",At+"/Apiv1/user/"),$t()(bt,"newUser",At+"/Apiv1/user"),$t()(bt,"userDisable",At+"/Apiv1/user/disable/"),$t()(bt,"userUnDisable",At+"/Apiv1/user/undisable/"),$t()(bt,"files",At+"/Apiv1/files"),$t()(bt,"file",At+"/Apiv1/file/"),$t()(bt,"fileDisable",At+"/Apiv1/file/disable/"),$t()(bt,"fileUnDisable",At+"/Apiv1/file/undisable/"),$t()(bt,"sha2Password",function(t){var e=""+xt()(t+"kloud"),s=""+xt()(e+"kloud");return console.log(t,e,s),s}),$t()(bt,"dateTime",function(t){var e=new Date(t);return Number(e)===Number(new Date("0001-01-01T00:00:00Z"))?"永久":e.toLocaleString()}),$t()(bt,"size",function(t){for(var e=t,s=0;e/1024>1;)e/=1024,s+=1;return e.toFixed(2)+["","K","M","G","T","P","E","Z","Y","B"][s]}),$t()(bt,"role",function(t){var e="游客";return 0===t?e="管理员":1===t&&(e="普通用户"),e}),$t()(bt,"isValidEntryName",function(t){return!It.test(t)&&"."!==t&&".."!==t}),$t()(bt,"copyLink",function(){var t=new Tt.a(".btn");t.on("success",function(e){console.log("复制成功"),t.destroy()}),t.on("error",function(e){console.log("该浏览器不支持自动复制"),t.destroy()})}),bt);r.default.use(o.a);var Et=new o.a.Store({state:{isLogin:!1,rootEntryId:"",userInfo:{id:"",name:"",email:"",role:2,avatarURL:"",createTime:"",disabled:!1,maxSize:0,curSize:0}},mutations:{unlogin:function(t){t.isLogin=!1},updateLoginStatus:function(t,e){t.userInfo=e,t.isLogin=!0,console.log("isLogin:",t.isLogin)},updateRootEntryId:function(t,e){var s=t.rootEntryId;t.rootEntryId=e,console.log("rootEntryId: ",s," -> ",t.rootEntryId)}},actions:{login:function(t,e){t.state;(0,t.commit)("updateLoginStatus",e)},logout:function(t){t.state,t.dispatch;(0,t.commit)("unlogin"),u.a.delete(Rt.login).then(function(t){console.log("logoutSucess: ",t)}).catch(function(t){console.log("logoutError: ",t)})},checkLogin:function(t){t.state,t.dispatch;var e=t.commit;u.a.get(Rt.login).then(function(t){200==t.status?(console.log("checkLoginSucess: ",t.data.data),e("updateLoginStatus",t.data.data)):kt.replace("/login")}).catch(function(t){console.log("checkLoginError: ",t)})},checkAdmin:function(t){var e=t.state,s=(t.dispatch,t.commit);console.log("checkAdmin"),e.isLogin?0!==e.userInfo.role&&kt.replace("/home"):u.a.get(Rt.login).then(function(t){200==t.status?(console.log("checkLoginSucess: ",t.data.data),s("updateLoginStatus",t.data.data),0!==t.data.data.role&&kt.replace("/home")):kt.replace("/login")}).catch(function(t){console.log("checkLoginError: ",t)})}}});u.a.defaults.withCredentials=!0,u.a.interceptors.request.use(function(t){return t},function(t){return console.log(t),c.a.Message.error({message:"请求超时!"}),n.a.resolve(t)}),u.a.interceptors.response.use(function(t){return t},function(t){return console.log(t.response.data),n.a.resolve(t.response)}),r.default.config.productionTip=!1,r.default.use(c.a),r.default.prototype.http=u.a,r.default.prototype.api=Rt,new r.default({el:"#app",store:Et,router:kt,components:{App:h},template:"<App/>"})},OAom:function(t,e){},OFwx:function(t,e){},bnQL:function(t,e){},c8Qy:function(t,e){},dkXx:function(t,e){},ebsp:function(t,e){},fRer:function(t,e){},lf27:function(t,e){},"m/qo":function(t,e){},"q+Pj":function(t,e){},xiRJ:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.c8546c1c9069512a9fcb.js.map